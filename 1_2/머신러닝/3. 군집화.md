# 군집화

## 1 군집화의 개념

### 데이터 집합의 분포 특성을 분석해 서로 교차하지 않는 복수 개의 부분집합으로 나누는 문제

- 입력 데이터로부터 추출된 특징 공간에서 특징값의 유사성에 따라 비슷한 데이터들끼리 묶음
  - 분류와 군집화의 차이 : 분류 - y값존재 -> 지도학습, 군집화 -> y값없음 ->비지도학습
  - 적용 방법론 
    - K-평균 군집화(K-means clustering)
    - 계층적 군집화(hierarchical clustering)
    - 가우시안 혼합(Gaussian mixture)
    - 자기 조직화 특징맵 SOM(Self Organizing Feature Map)

#### - 군집화가 적용 가능한 데이터

- 데이터에 대한 클래스 레이블이 주어지지 않는 경우
- 데이터에 대한 클래스 레이블링에 비용이 많이 드는 경우



## 2. K-평균 군집화

### 주어진 데이터 집합을 K개의 그룹으로 묶는 알고리즘

- 수행단계 : 시작 -> 데이터 그룹핑 -> 대표 벡터 수정 -> 반복 여부 결정
  - 1. 시작(초기화)
       - 데이터 집합으로부터 임의로 K개의 벡터를 선택 해 K개의 초기 대표 벡터 집합을 생성
  - 2. 데이터 그룹핑
       - 각데이터에 대해 K개의 대표 벡터와의 거리를 구해 가장 가까운 데이터들을 레이블링 하고 K개의 클러스터로 나눔
  - 3. 대표 벡터 수정
       - 새로운 클러스터들에서 각각의 대표 벡터를 갱신
  - 4. 반복여부 결정
       - 수정 전의 대표벡터와 수정 후 대표벡터의 차이를 계산 해 설정된 반복 횟수에 도달할 때까지 2~4단계 반복
- 실제 적용에 고려해야할 사항
  - 좋은 군집을 찾는 것이 확실히 보장되는가
  - 초기 대표 벡터 설정이 군집화 성능에 미치는 영향
  - 데이터에 의존하는 적절한 K값
- 알고리즘 특성
  - 한번 반복할 때마다 목적함수의 값이 줄어드는 방향으로 학습진행
  - J(목적함수)값을 결정하는 파라미터 : 대표벡터, 각 데이터에 대한 클러스터 레이블



## 3.계층적 군집화

- 전제데이터를 몇 개의 배타적 그룹으로 나누는 대신, 큰 군집이 작은 군집을 포함하는 형태로 

  계층을 이루도록 군집 수행

- 1. 병합적 방법 BOTTOM UP
     - 하나의 군집을 이루는 최소 군집에서 시작해 가까운 군집끼리 단계적 병합으로 더 큰 군집을 만듬
     - N-1번의 병합과정 필요
  2. 분할적 방법 TOP DOWN
     - 하나의 군집에 속하는 최대군집에서 시작해 특정 기준에 따라 군집들을 분할 -> 비실용적



- 병합적 알고리즘 수행
  - 1. 데이터의 집합으로부터 각 데이터가 각각의 군집이 되도록 N개의 군집 설정
    2. 가능한 모든 군집 쌍에 대해 군집 간의 거리 계산
    3. 거리가 가장 가까운 두 군집을 선택해 병합하고 새로운 군집을 생성
    4. 새로운 군집을 군집 풀에 넣고 원래 군집을 제거
    5. 오직 1개의 군집이 남을 때까지 2~5번 과정 반복

- 군집간의 거리 계산 방식
  - 최단연결법 : 가장 가까운 데이터 쌍 간의 거리
    - 고립된 군집을 찾는데 유용
  - 최장연결법 : 가장 멀리 떨어진 데이터 쌍 간의 거리
    - 응집된 군집을 찾는데 중점
  - 와드 방법 : 병합 후의 클러스터 내부의 분산값
    - 비슷한 크기의 군집을 병합

- 덴드로그램으로부터 적합한 군집의 수 결정방법

  - 덴드로그램 클러스터 간 거리가 증가하는 동안 클러스터의 수가 늘어나지 않고 

    일정기간 유지되는 지점 선택